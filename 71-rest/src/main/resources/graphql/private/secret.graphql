extend type Mutation {
  createSecret(input: CreateSecretInput!): CreateSecretsPayload @dataFetcher(name: createSecret)
  updateSecret(input: UpdateSecretInput!): UpdateSecretPayload @dataFetcher(name: updateSecret)
  deleteSecret(input: DeleteSecretInput!): DeleteSecretPayload @dataFetcher(name: deleteSecret)
}

input CreateSecretInput {
  clientMutationId: String
  secretType: SecretType!
  encryptedText: EncryptedTextInput
  winRMCredential: WinRMCredentialInput
  sshCredential: SSHCredentialInput
}

input DeleteSecretInput {
  clientMutationId: String
  secretId: String!
}

type DeleteSecretPayload {
  clientMutationId: String
}

enum SecretType {
  ENCRYPTED_TEXT
  WINRM_CREDENTIAL
  SSH_CREDENTIAL
}

type CreateSecretsPayload {
  clientMutationId: String
  secret: Secret
}

interface Secret {
  id: String
  secretType: SecretType
  name: String
  usageScope: UsageScope
}

input UpdateSecretInput {
  clientMutationId: String
  id: String!
  secretType: SecretType!
  encryptedText: UpdateEncryptedText
  winRMCredential: UpdateWinRMCredential
  sshCredential: UpdateSSHCredential
}

type UpdateSecretPayload {
  clientMutationId: String
  secret: Secret
}
